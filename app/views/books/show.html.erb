<a class="back-button" href="<%= books_url %>">ALL BOOKS</a>

<header class="page-title"><%= @book.title %></header>

  <div class="group">
    <div class="book-description">
      <h3 class="author"><%= @book.author %></h3>
      <div class="desctiprion"><%= @book.description.html_safe %></div>
    </div>
    <div class="book-image">
      <img class="cover" src="<%= @book.pic %>">
      <div class="likes-section">
              <%=render partial: "likes/list_likes", locals: {book: @book, is_reviewed: @current_user_review, book_rating: @book_rating, dislike_count: @dislike_count, like_count: @like_count} %>
      </div>
  		</div>
    </div>

    <div class="my-post">
    <% if @current_user_review %>
      <header class="sub-title">My Review</header>
      <%=render partial: "posts/post", locals: {post: @current_user_review, modifiable: true} %>
    <% elsif current_user %>
     	 <header class="sub-title">New Review</header>
     	 <%= render "posts/form_review", book: @book  %>
 	 <% end %>
   </div>



   <header class="sub-title">Reviews:</header>
   <div class="posts-list">
	   <%= render "posts/list_posts", :posts => @posts, :book_page => "hide-tag" %>
   </div>


<script>
$(document).ready(function (){ 
    $("body").on("ajax:success", ".post-delete-form", function (event, data) {
      event.preventDefault();
      
      $insertion = $(".my-post")
      $insertion.children(".sub-title").html("New Review")
      $insertion.append(data)


      $insertion.children(".post").remove()

    });
    
    
    $("body").on("ajax:error", ".post-delete-form", function (event, data) {
      console.log("ERROR DELETING POST")
    });
    
    $("body").on("ajax:success", ".like-form", function (event, data) {
      event.preventDefault();
      
      console.log(data)
      $insertion = $(".likes-section")
      
      $insertion.html(data)

    });
    
    
    
    $("body").on("ajax:success", ".comment-delete-form", function (event, data) {
      event.preventDefault();
      $(this).parent().remove();
    });
    
    
    $("body").on("ajax:error", ".comment-delete-form", function (event, data) {
      console.log("ERROR DELETING COMMENT")
      console.log(data)
    });
    
});
</script>
